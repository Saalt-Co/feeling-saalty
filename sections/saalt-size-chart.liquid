{{ 'component-size-chart.css' | asset_url | stylesheet_tag }}
<script src="{{ 'size-chart.js' | asset_url }}" defer="defer"></script>

<size-chart>
  {%- liquid
    assign titles = ''
    assign content = ''
    for block in section.blocks
      case block.type
        when 'saalt-size-chart'
          assign titles = titles | append: block.settings.size_chart_title
          unless forloop.last
            assign titles = titles | append: 'ʕ•ᴥ•ʔ'
          endunless
          assign content = content | append: block.settings.size_chart_page.content
          unless forloop.last
            assign content = content | append: 'ʕ•ᴥ•ʔ'
          endunless
      endcase
    endfor
    assign split_titles = titles | split: 'ʕ•ᴥ•ʔ'
    assign split_content = content | split: 'ʕ•ᴥ•ʔ'
  -%}

  {%- for block in section.blocks -%}
  {%- case block.type -%}
    {%- when 'section_title' -%}
      {%- if block.settings.title != blank -%}
        {%- capture section_title_code -%}
        <h{{ block.settings.heading_tag }} class="section-title mobile-{{ block.settings.mobile_text_alignment }} desktop-{{ block.settings.desktop_text_alignment }}">
          {{- block.settings.title -}}
        </h{{ block.settings.heading_tag }}>
        {%- endcapture -%}
      {%- endif -%}
    {%- when 'saalt-size-chart' -%}
      {%- capture tab_code -%}
      <label for="size-chart-tab-{{ forloop.index }}">
        {{ block.settings.size_chart_title }}
      </label>
      <input type='radio' id='size-chart-tab-{{ forloop.index }}' name='size-chart-tab' class="size-chart-title-button" {%- if forloop.first -%}checked{%- endif -%}></input>
      <div class='size-chart-content-tab'>
        {{ block.settings.size_chart_page.content }}
      </div>
      {%- endcapture -%}
      {%- assign tabs_code = tabs_code | append: tab_code -%}
    {%- endcase -%}
  {%- endfor -%}

  {{ section_title_code }}
  <div class="size-chart-tabs">
    <div class="size-chart-titles">
      <ul class="size-chart-titles-ul">
        {%- for title in split_titles -%}
          <li class="size-chart-titles-li">
            <button class="size-chart-title-button{% if forloop.first %} active{% endif %}" name="tab-{{ forloop.index }}">{{ title }}</button>
          </li>
        {%- endfor -%}
      </ul>
    </div>
    <div class="size-chart-content-containers">
      {%- for content in split_content -%}
        <div class="size-chart-content-container{% if forloop.first %} visible{% endif %}" name="content-container-{{ forloop.index }}">{{ content }}</div>
      {%- endfor -%}
    </div>
  </div>

</size-chart>

{%- style -%}
  #section-{{ section.id }} size-chart .section-title {
    display: block;
    width: 100%;
  }
  #section-{{ section.id }} size-chart .section-title > p {
    margin: 0;
  }
  #section-{{ section.id }} size-chart .section-title.mobile-center {
    text-align: center;
  }
  #section-{{ section.id }} size-chart .section-title.mobile-left {
    text-align: left;
  }
  #section-{{ section.id }} size-chart .section-title.mobile-right {
    text-align: right;
  }
  #section-{{ section.id }} size-chart .section-title.mobile-justify {
    text-align: justify;
  }
  @media (min-width: 750px) {
    #section-{{ section.id }} size-chart .section-title.desktop-center {
      text-align: center;
    }
    #section-{{ section.id }} size-chart .section-title.desktop-left {
      text-align: left;
    }
    #section-{{ section.id }} size-chart .section-title.desktop-right {
    text-align: right;
    }
    #section-{{ section.id }} size-chart .section-title.desktop-justify {
      text-align: justify;
    }
  }
{%- endstyle -%}

{% schema %}
{
  "name": "Saalt Size Chart",
  "settings": [
    {
      "type": "text",
      "id": "section_id",
      "label": "Section ID (Optional)",
      "info": "Typically only used when setting this ID as a link's destination."
    }
  ],
  "blocks": [
    {
      "type": "section_title",
      "name": "Section Title (Optional)",
      "settings": [
        {
          "type": "select",
          "id": "heading_tag",
          "label": "Heading Tag",
          "options": [
            {
              "value": "1",
              "label": "H1"
            },
            {
              "value": "2",
              "label": "H2"
            },
            {
              "value": "3",
              "label": "H3"
            }
          ],
          "default": "2"
        },
        {
          "type": "richtext",
          "id": "title",
          "label": "Title",
          "default": "<p>Section Title Goes Here</p>"
        },
        {
          "type": "select",
          "id": "mobile_text_alignment",
          "label": "Title alignment on *MOBILE*",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "justify",
              "label": "Justify"
            }
          ],
          "default": "center"
        },
        {
          "type": "select",
          "id": "desktop_text_alignment",
          "label": "Title alignment on *DESKTOP ONLY*",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "justify",
              "label": "Justify"
            }
          ],
          "default": "center"
        }
      ]
    },
    {
      "type": "saalt-size-chart",
      "name": "Saalt Size Chart",
      "settings": [
        {
          "type": "text",
          "id": "size_chart_title",
          "label": "Size Chart Title",
          "info": "This is the title of the size chart tab"
        },
        {
          "type": "page",
          "id": "size_chart_page",
          "label": "Size Chart Page Content",
          "info": "Please select a page to use its content as a size chart tab"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Saalt Size Chart",
      "category": "custom saalt section",
      "settings": {},
      "blocks": [
        {
          "type": "saalt-size-chart",
          "settings": {}
        },
        {
          "type": "saalt-size-chart",
          "settings": {}
        },
        {
          "type": "saalt-size-chart",
          "settings": {}
        }
      ]
    }
  ]
}
{% endschema %}
